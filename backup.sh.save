#!/bin/bash

lastBackup=$(ls ~ | grep -E "^Backup-" | sort -n | tail -1)
lastDate=$(echo $lastBackup | cut -c "8-17")
lastDateSec=$(date -d "$lastDate" +%s)
newDate=$(date +"%Y-%m-%d")
newDateSec=$(date -d "$newDate" +%s)
let dateDiff=($newDateSec-$lastDateSec)/3600/24

if [[ "$dateDiff" -ge 7 ]]
then
	mkdir ~/Backup-$newDate
	files=$(ls ~/source)
	for file in $files
	do
	cp ~/source/$file ~/Backup-$newDate
	done
	echo "New Backup:$HOME/Backup-$newDate;Files:$files" >> ~/backup-report
else
	files=$(ls ~/source)
	for file in $files
	do
	if [[ ! -f $file ]]
	then
		cp ~/source/$file ~/$lastBackup
	else
		lastSize=$(stat -c%s ~/lastBackup/$file)
		newSize=$(stat -c%s ~/source/$file)
	
	fi
	done
fi
#newBackup="Backup-$date"
#let dateDiff=$($newDate-$lastDate)
#echo "$dateDiff"
